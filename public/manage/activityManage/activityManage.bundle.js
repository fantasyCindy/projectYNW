!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="/public/bundle/",e(0)}([function(t,e){"use strict";layui.use(["layer","laypage","laydate"],function(){var t=function(){var t,e,i={currentPage:1,pageSize:10},r=null,a=null,c=function(t){return _.map(t,function(t){return"<tr>\n                <td>"+t.activity_name+"</td>\n                <td>"+t.start_time+"</td>\n                <td>"+t.end_time+"</td>\n                <td>"+t._text+'</td>\n                <td class="edit" data-id=\''+t.id+"'>编辑</td>\n            </tr>"}).join("")},d=function(t){return _.map(t,function(t){return t._text=["否","是"][t.is_start],t})};return{init:function(){t=$(".activity-manage"),e=t.find(".table-wrap"),e.on("click",".edit",function(){var t=$(this).data("id"),e=_.filter(a,{id:t});n.render(e)})},render:function(t){_.extend(i,t),$.getJSON(__path+"/activity/activityList.do",i,function(t){t.list.length>0?(r=t.total,a=t.list,e.html(c(d(t.list)))):e.html('<tr><td colspan="10"><div class="activity-none">暂无记录</div></td></tr>')})},getTotal:function(){return r}}}(),e=layui.laypage;setTimeout(function(){e.render({elem:"page",count:t.getTotal(),skin:"#ececec",jump:function(e,n){t.render({currentPage:e.curr})}})},800);var n=function(){var e,i,r={},a=null,c=null,d=null,u=!1,l=[],o=null;return{init:function(){e=$(".activity-manage"),i=e.find(".createWin"),e.on("click",".createBtn",function(){n.render()});var s=(new Date).getTime(),f=layui.laydate;f.render({elem:"#dateTime",range:"~",type:"datetime",min:s,done:function(t){a=t}}),i.on("click",".btn-submit",function(){var e=i.find(".createName input").val().trim();if(!e)return layer.msg("请输入活动名称");var s=a?a:o;if(!s)return layer.msg("请设置活动时间");l=s.split("~"),c=l[0],d=l[1];var f=i.find(".isCreate select").val();return f?(r.activity_name=e,r.start_time=c,r.end_time=d,r.is_start=f,void $.post(__path+"/activity/addoredit.do",r,function(e){"success"==e&&(u?layer.msg("修改成功"):layer.msg("创建成功")),n.reset(),t.render()})):layer.msg("活动是否开启")}),i.on("click",".btn-cancel",function(){n.reset()})},render:function(t){t&&(u=!0,r.id=t[0].id,o=t[0].start_time+"~"+t[0].end_time,i.find(".createTime input").val(t[0].start_time+"~"+t[0].end_time),i.find(".createName input").val(t[0].activity_name),i.find("select").val(t[0].is_start)),i.fadeIn()},reset:function(){i.hide(),a="",i.find("input").val(""),i.find("select").val(""),u=!1}}}();$(function(){t.init(),n.init(),t.render()})})}]);