"use strict";function getNewsList(e){var t=$.Deferred();e=_.extend({type:"",page:1,row:20},e);var n={backnews_type:e.type,currentPage:e.page,pageSize:e.row};return $.getJSON("/article/queryNews.htm",n,function(n){n.pageNumber=_.max([1,Math.ceil(+n.total/e.row)]),t.resolve(n)}),t.promise()}var types=["","热门资讯","涨停揭秘","宏观要闻","个股资讯"],newslist=function(){function e(e){return _.map(e,function(e){return e.create_time=yn.timeFormat(e.create_time),e.content=yn.filterHTML(e.content,{trim:!0,substr:200}),e})}var t,n,r,i,o=1,s=6,a=$("body");return{init:function(){var e=this;t=$("#newslist"),items=t.find(".items"),r=$("#title-top"),n=yn.bootpag(".list"),n.on("page",function(t,n){o=n,e.render(i),a.velocity("scroll",{duration:350,offset:0})});var s=new yn.loading;s.container=items,s.type=3,s.margin=200,s.render()},render:function(t){i=t,r.text(types[i]),getNewsList({page:o,row:s,type:i}).done(function(t){console.log("资讯",t),t.rows=e(t.rows),items.html(template("newslist-item-template",t.rows)),n.bootpag({page:o,total:t.pageNumber})})}}}(),newsOther=function(){function e(e){return _.map(e,function(e){return e.title=e.title.substr(0,18)+"...",e})}var t,n=1,r=5;return{init:function(){t=$(".yn-right")},render:function(i){getNewsList({page:n,row:r,type:i}).done(function(n){console.log("其他资讯",n),n.title=types[i],n._type=i,n.rows=e(n.rows),t.find(".news-item-"+i).html(template("list-template",n))})}}}();$(function(){var e=yn.MarketIndex();e.render($("#stockIndex"),"column"),newslist.init(),newsOther.init();var t=[{t:1,key:1},{t:2,key:2},{t:3,key:3},{t:4,key:4}],n=0,r=window.location.href.match(/list=([1-4])/);r&&(n=r[1]-1),t[n].t=0,t.sort(function(e,t){return e.t-t.t}),newslist.render(t[0].key),newsOther.render(t[1].key),newsOther.render(t[2].key),newsOther.render(t[3].key)});