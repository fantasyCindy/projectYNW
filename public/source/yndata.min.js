"use strict";var yndata={};yndata.postQuestion=function(e){var r=$.Deferred(),t="/auth/allTeacherQuestions.htm";return $.get(t,{content:e},function(e){"success"==e?(layer.msg("提问成功"),r.resolve()):(layer.alert("提问失败"),r.reject())}),r.promise()},yndata.postQuestionForTeacher=function(e,r,t){var n=$.Deferred();return t=_.extend({stockCode:"",stockName:""},t),$.post("/auth/teacherQuestion.htm",{teacherId:e,content:r,stock_code:t.stockCode,stock_name:t.stockName},function(e){return 10==+e?(layer.alert("直播室已经关闭，暂时不能提问"),void n.reject()):void("success"==e?(layer.msg("提问成功"),n.resolve()):(layer.alert("提问失败"),n.reject()))}),n.promise()},yndata.getHotLive=function(e){e=_.extend({rows:6,page:1},e);var r=$.Deferred();return $.ajax({url:"/html/hotLiveRooms.htm?",data:e,dataType:"json",success:function(e){r.resolve(e)}}),r.promise()},yndata.getTopIncome=function(e){var r=$.Deferred();return e=_.extend({row:3,take:6},e),$.ajax({url:"/html/capitalShow.htm?",data:{num:e.row},dataType:"json",success:function(t){t=_.map(t,function(e,r){return{name:e.title,feed:e.popularity_number,income:e.revenue,teacherid:e.teacherid}});var n=_.take(t,e.take);r.resolve(n)}}),r.promise()},yndata.getHotVideo=function(e){var r=$.Deferred();return e=_.extend({page:1,row:3},e),$.getJSON("/video/list.htm",{pageSize:e.row,currentPage:e.page},function(e){e=_.map(e,function(e,r){return e.video_src=e.video_src.replace(/http:\\\/\\\//,"http://"),e}),r.resolve(e)}),r.promise()},yndata.hotAsk=function(e){e=_.extend({currentPage:1,pageSize:3},e);var r={pageSize:e.pageSize,currentPage:e.currentPage},t=$.Deferred();return $.getJSON("/consultation/queryHotStock.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getHotArticle=function(e){var r=$.Deferred();return e=_.extend({page:1,row:5,showType:0},e),$.ajax({url:"/html/lastedArticle.htm?",dataType:"json",data:{page:e.page,rows:e.row,showType:0},success:function(e){e=_.map(e,function(e){return e.link_path=e.link_path.replace("http://www.yuetougu.com/",""),e}),r.resolve(e)}}),r.promise()},yndata.getHotNews=function(e){var r=$.Deferred();return e=_.extend({page:1,row:10},e),$.getJSON("/article/rmzxList.htm",{pageSize:e.row,currentPage:e.page},function(e){r.resolve(e)}),r.promise()},yndata.getHotTeacher=function(e){var r=$.Deferred();e=_.extend({page:1,row:7,type:"total",unit:null},e);var t={orderStype:e.type,rows:e.row};switch(e.type){case"total":t.orderStype=0;break;case"ask":t.orderStype=1}return"month"==e.unit&&(t.monNum=5),$.ajax({url:"/html/teacherOrderList.htm?",data:t,dataType:"json",success:function(e){e=_.map(e,function(e,r){return e.index=r+1,e}),r.resolve(e)}}),r.promise()},yndata.getBroadcastList=function(e){var r=$.Deferred(),t="/html/broadcastingList.htm";return e=_.extend({order:"attentionnumber",sort:"desc",type:2},e),$.getJSON(t,{order:e.order,sort:e.sort,type:e.type},function(e){r.resolve(e)}),r.promise()},yndata.recommendLive=function(e){var r=$.Deferred(),t="/html/roomOrderList.htm";return e=_.extend({type:0,row:7},e),$.getJSON(t,{orderStype:e.type,rows:e.row},function(e){e=_.compact(e),r.resolve(e)}),r.promise()},yndata.getNews=function(e){var r=$.Deferred();return e=_.extend({page:1,row:10,titleSub:20,contentSub:130},e),$.ajax({type:"GET",url:"/article/zdxwList.htm",data:{pageSize:e.row,currentPage:e.page},dataType:"json",cache:!1,success:function(t){t.rows=_.map(t.rows,function(r){return r.content.length>e.contentSub&&(r.content=(r.content.substr(0,e.contentSub)+"...").replace(/\s+/g,"")),r.title.length>e.titleSub&&(r.title=r.title.substr(0,e.titleSub)+"..."),r}),t.pageNumber=_.max([1,Math.ceil(+t.total/e.row)]),r.resolve(t)}}),r.promise()},yndata.getHotRanking=function(e){var r=$.Deferred();e=_.extend({orderType:-1,row:20},e);var t={orderType:e.orderType,row:e.row};return $.getJSON("/html/investmentAdviserOrderList.htm",t,function(e){e=_.map(e,function(e,r){return e.index=r+1,e}),r.resolve(e)}),r.promise()},yndata.getMyCustomStock=function(ops){function handleItem(item){var data=eval(item.stockInfo),open=yn.setDecimal(+data[1]),yesterday=data[2],now=yn.setDecimal(data[3])||open,high=data[4],low=data[5],up=yn.setDecimal((now-yesterday)/yesterday*100),money=yn.setDecimal(now-yesterday),result={stockcode:item.stockcode,stockname:item.stockname,stockid:item.id,now:yn.colorValue(now,{left:now-open}),money:yn.colorValue(money),up:yn.colorValue(up,{suffix:"%"}),yesterday:yn.setDecimal(yesterday),open:yn.setDecimal(open),max:yn.setDecimal(high),min:yn.setDecimal(low)};return result}ops=_.extend({userid:ynUserId});var defer=$.Deferred();return $.getJSON("/queryOp.htm",{user_id:ops.userid},function(e){e=_.chain(e).filter(function(e){return e.stockInfo}).map(function(e){return handleItem(e)}).value(),defer.resolve(e)}),defer.promise()},yndata.addMyCustomStock=function(e,r){var t=$.Deferred();return r=_.extend({user_id:ynUserId},r),e&&e.stockname&&e.stockcode?(e.user_id=r.user_id,yndata.getMyCustomStock(e.user_id).done(function(r){var n=!0;_.forEach(r,function(r){+r.stockcode==+e.stockcode&&(layer.msg("已存在"),n=!1)}),n&&$.post("/addOpStock.htm",e,function(e){t.resolve(e)})}),t.promise()):void console.log("添加自选参数错误",e)},yndata.removeMyCustomStock=function(e,r){var t=$.Deferred();return r=_.extend({user_id:ynUserId}),e.user_id=r.user_id,!e&&!e.stockname&!stockCode&&!e.id?void layer.msg("yndta.removeMyCustomStock : 参数错误"):($.get("/deleteOpStock.htm",e,function(r){"success"==r?t.resolve(e.stockCode):(layer.msg("yndta.addMyCustomStock: 删除自选股失败..."),t.reject(e.stockCode))}),t.promise())},yndata.getVideoCount=function(){var e=$.Deferred();return $.get("/video/collageListCount.htm",function(r){e.resolve(r)}),e.promise()},yndata.getVideoCategory=function(){var e="/videoType/select.htm",r=$.Deferred();return $.getJSON(e,function(e){r.resolve(e)}),r.promise()},yndata.getVideos=function(e){var r=$.Deferred();e=_.extend({type:"",album:"",time:"1",look:"",page:1,row:12},e);var t={videoType:e.type,byAlbum:e.album,byCreateTime:e.time,byLookCount:e.look,pageSize:e.row,currentPage:e.page};return $.getJSON("/video/collageList.htm",t,function(t){t.pageNumber=_.max([1,Math.ceil(+t.total/e.row)]),r.resolve(t)}),r.promise()},yndata.getPersonInfo=function(e){e=_.extend({userid:ynUserId});var r=$.Deferred();return $.getJSON("/center/queryUserInfo.htm",{user_id:e.userid},function(e){return 0===e?void layer.alert("参数为空"):2===e?void layer.alert("用户不存在"):8===e?void layer.alert("用户信息有误"):(void 0===e.specialtys&&(e.specialtys=[]),void r.resolve(e))}),r.promise()},yndata.getHotOpinion=function(e){e=_.extend({page:1,row:10},e);var r={currentPage:e.page,pageSize:e.row},t=$.Deferred();return $.getJSON("/html/liveLastedArticle.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getMyOpinion=function(e){e=_.extend({userid:ynUserId,isDraft:!1,page:1,row:10},e);var r={user_id:e.userid,is_draft:e.isDraft?1:0,pageSize:e.row,currentPage:e.page},t=$.Deferred();return $.getJSON("/center/queryMyView.htm",r,function(r){if(r===-1)return void layer.alert("身份信息有误，请联系客服！");if(0===r)return void layer.alert("参数错误");var n=e.isDraft?r.headdata.draftcount:r.headdata.viewcount,a=_.max([Math.ceil(n/e.row),1]);r.pageNumber=a,t.resolve(r)}),t.promise()},yndata.postOpinion=function(e,r){r=_.extend({is_draft:0},r),e.is_draft=r.is_draft;var t=$.Deferred();return $.post("/center/addEditView.htm",e,function(e){return"-1"==e?void layer.alert("身份信息有误，请联系客服！"):void("success"==e&&t.resolve())}),t.promise()},yndata.modifyValues=function(e,r){r=_.extend({is_draft:1},r),e.is_draft=r.is_draft;var t=$.Deferred();return $.post("/center/addEditView.htm",e,function(e){return"-1"==e?void layer.alert("身份信息有误，请联系客服！"):void("success"==e&&t.resolve())}),t.promise()},yndata.removeOpinion=function(e){var r=$.Deferred();return layer.confirm("确定要删除吗",{icon:3},function(t){$.post("/center/addEditView.htm",{article_id:e,is_del:1,dr:1},function(e){"success"==e&&r.resolve()}),layer.close(t)}),r.promise()},yndata.getMyLiveList=function(e){e=_.extend({userid:ynUserId,page:1,row:10},e);var r={user_id:e.userid,pageSize:e.row,currentPage:e.page},t=$.Deferred();return $.getJSON("/center/queryMyLive.htm",r,function(r){return"-1"==r?void layer.alert("身份信息有误，请联系客服！"):(r.pageNumber=_.max([1,Math.ceil(r.total/e.row)]),void t.resolve(r))}),t.promise()},yndata.getMyRefer=function(e){e=_.extend({puiblisherid:ynUserId,page:1,row:10},e);var r={puiblisherid:e.puiblisherid,currentPage:e.page,pageSize:e.row},t=$.Deferred();return $.getJSON("/center/reference/list.htm",r,function(r){var n=Math.ceil(r.total/e.row);r.pageNumber=n>1?n:1,t.resolve(r)}),t.promise()},yndata.getRefer=function(e,r){r=_.extend({userid:ynUserId,pge:1,row:10},r);var t={teacherid:e,user_id:r.userid,pageSize:r.row,currentPage:r.page},n=$.Deferred();return $.getJSON("/qreference/list.htm",t,function(e){n.resolve(e)}),n.promise()},yndata.getLiveContent=function(e,r){r=_.extend({page:1,row:60},r);var t={periodicalid:e,pageSize:r.row,currentPage:r.page},n=$.Deferred();return $.getJSON("/html/liveInfo.htm?"+yn.timestamp(),t,function(e){e.pageNumber=Math.ceil(e.total/r.row),n.resolve(e)}),n.promise()},yndata.publishLiveContent=function(e,r){if("success"!=ynIsLogin)return void layer.alert("请登录...");if(!r)return void layer.alert("请输入内容...");var t=$.Deferred();r=r.replace(/(<img)\s+(?:class="big_pic")?(.+?(jpg"|png"))/g,'$1  $2 class="big_pic"');var n={periodicalid:e,content:r};return $.post("/teacher/html/broadcasting/addBroadcasting.htm",n,function(e){"success"==e&&(layer.msg("发表成功"),t.resolve(e))}),t.promise()},yndata.getFriendTalk=function(e,r){var t=$.Deferred(),r=_.extend({page:1,row:10},r),n={periodicalid:e,currentPage:r.page,pageSize:r.row};return $.getJSON("/html/interactionList.htm",n,function(e){e.hasMore=e.length==r.row,e=e.reverse(),t.resolve(e)}),t.promise()},yndata.getLiveHistory=function(e,r){r=_.extend({page:1,row:10},r);var t={teacherid:e,currentPage:r.page,pageSize:r.row},n=$.Deferred();return $.getJSON("/html/periodicalList.htm",t,function(e){e.pageNumber=_.max([Math.ceil(e.total/r.row),1]),n.resolve(e)}),n.promise()},yndata.getMyVideo=function(e){e=_.extend({teacherid:ynTeacherId,page:1,row:10,isDraft:!1},e);var r={teacherid:e.teacherid,currentPage:e.page,pageSize:e.row,isDraft:e.isDraft?1:0},t=$.Deferred();return $.getJSON("/video/videoList.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.getCareList=function(e){e=_.extend({userid:ynUserId,page:1,row:20},e);var r={user_id:e.userid,currentPage:e.page,pageSize:e.row},t=$.Deferred();return $.getJSON("/center/attentionList.htm",r,function(r){r.pageNumber=_.max([1,+r.total/e.row]),t.resolve(r)}),t.promise()},yndata.addCare=function(e,r){var t=$.Deferred();return $.post("/center/attention.htm",{user_id:e,teacherid:r},function(e){"success"==e&&(layer.msg("关注成功"),t.resolve())}),t.promise()},yndata.cancelCare=function(e,r){var t=$.Deferred();return $.post("/center/attention.htm",{user_id:e,teacherid:r},function(e){"success"==e&&(layer.msg("取消成功"),t.resolve())}),t.promise()},yndata.feedback=function(e,r){var t=$.Deferred();return r=_.extend({creatorid:ynUserId,content:e},r),$.post("/feedback/add.htm",r,function(e){"success"==e&&(layer.alert("收到您宝贵的意见，我们会做得更好"),t.resolve())}),t.promise()},yndata.mass=function(e,r){var t=$.Deferred(),n={tmessagetitle:e,tmessagecontent:r};return $.post("/teachermessage/add.htm",n,function(e){"success"==e?(layer.alert("发送成功"),t.resolve()):yn.log("msg : send message to all",e)}),t.promise()},yndata.getLastestChat=function(e,r){var t=$.Deferred();return r=_.extend({page:1,row:10},r),$.getJSON("/consultation/lastedNote.htm",{pageSize:r.row,currentPage:r.page},function(e){e.pageNumber=_.max([Math.ceil(+e.total/r.row),1]),t.resolve(e)}),t.promise()},yndata.getMyChat=function(e,r){var t=$.Deferred();return r=_.extend({page:1,row:10,isReplay:!0,user_id:ynUserId},r),$.getJSON("/consultation/myNoteList.htm",{pageSize:r.row,currentPage:r.page,self:r.isReplay},function(e){e.pageNumber=_.max([Math.ceil(+e.total/r.row),1]),t.resolve(e)}),t.promise()},yndata.getNewChat=function(e){e=_.extend({page:1,row:10,best:"",type:-1},e);var r={currentPage:e.page,pageSize:e.row,note_type:e.type>=0?e.type:"",is_adopt:e.best},t=$.Deferred();return $.getJSON("/consultation/lastedNote.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.Statistics=function(){var e=$.Deferred();return $.getJSON("/consultation/queryAnswerCountAndReadCount.htm",function(r){e.resolve(r)}),e.promise()},yndata.getArticleCommon=function(e,r){r=_.extend({page:1,row:10,type:0},r);var t={articleId:e,type:r.type,currentPage:r.page,pageSize:r.row},n=$.Deferred();return $.getJSON("/articleCommentList.htm",t,function(e){return"-1"==e.rows.status?(layer.msg("评论出错"),void n.reject()):(e.pageNumber=_.max([1,Math.ceil(+e.total/r.row)]),void n.resolve(e))}),n.promise()},yndata.postArticleCommon=function(e,r,t){t=_.extend({type:0,parentId:""},t);var n=$.Deferred(),a={article_id:e,content:r,type:t.type,parent_id:t.parentId};return console.log("send",a),$.post("/articleCommentReply.htm",a,function(e){"1"==e.rows.status&&layer.msg("发表成功"),n.resolve(e)},"json"),n.promise()},yndata.postNewsComment=function(e,r){var t=$.Deferred(),n={backnews_id:e,content:r,create_id:ynUserId};return $.post("/article/commentNews.htm",n,function(e){"success"==e?t.resolve(e):layer.msg("评论成功")}),t.promise()},yndata.getNewsComment=function(e,r){r=_.extend({page:1,row:10},r);var t={currentPage:r.page,pageSize:r.row,backnews_id:e},n=$.Deferred();return $.getJSON("/article/queryNewsComments.htm",t,function(e){e.pageNumber=_.max([1,Math.ceil(+e.total/r.row)]),n.resolve(e)}),n.promise()},yndata.getMyAnswer=function(e){e=_.extend({userid:ynUserId,isReply:0,page:1,row:10},e);var r={userid:e.userid,is_reply:e.isReply,pageSize:e.row,currentPage:e.page},t=$.Deferred();return $.getJSON("/center/queryMyanswer.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),r.head=r.rows.headdata,r.body=r.rows.bodydata,r.rows=null,t.resolve(r)}),t.promise()},yndata.getMyAnswerWithType=function(e,r){r=_.extend({teacherid:e,page:1,row:10,type:0},r);var t={teacherid:r.teacherid,pageSize:r.row,currentPage:r.page,type:r.type},n=$.Deferred();return $.getJSON("/live/queryTeacherNoteByType.htm",t,function(e){e.pageNumber=_.max([1,Math.ceil(+e.total/r.row)]),n.resolve(e)}),n.promise()},yndata.replyQuestion=function(e,r){var t={noteid:e,answercontent:r},n=$.Deferred();return $.post("/center/answer.htm",t,function(e){(e="success")&&(layer.msg("回答成功"),n.resolve(e))}),n.promise()},yndata.getPhoneCode=function(e,r){if(!yn.isMobile(r))return void layer.alert("请输入正确手机号码");e.html("<span id='sendCount'>60</span>秒后可以再次获取!"),e.removeClass("sendbefore").addClass("sendafter");var t=e.css("background-color"),n=e.css("border-color");e.css({background:"gray","border-color":"gray"}),e.get(0).disabled=!0;var a=setInterval(function(){var r=$("#sendCount"),o=Number(r.text());o>1?(o--,r.text(o)):(e.get(0).disabled=!1,e.html("获取手机验证码"),e.css({"background-color":t,"border-color":n}),clearInterval(a))},1e3);$.post("/sendPhoneCode.htm",{phone:r},function(e){"-1"===e&&layer.alert("短信发送失败，请重试!")})},yndata.getCity=function(e){var r=$.Deferred();return $.getJSON("/address/queryCity.htm?parentid="+e,function(e){var t="";_.forEach(e,function(e){t+='<option value="'+e.address_id+'">'+e.address_name+"</option>"}),r.resolve(t)}),r.promise()},yndata.getGoodat=function(){var e=$.Deferred();return $.getJSON("/center/specialty.htm",function(r){e.resolve(r.rows)}),e.promise()},yndata.getInvestType=function(){var e=$.Deferred();return $.getJSON("/investmenttypes/select.htm",function(r){e.resolve(r)}),e.promise()},yndata.getHoldStock=function(e){var r=$.Deferred();return $.getJSON("/webstock/webQueryshlist.htm",{teacherid:e},function(e){r.resolve(e)}),r.promise()},yndata.getStockTradeHistory=function(e,r){r=_.extend({page:1,row:10},r);var t=$.Deferred();return $.getJSON("/webstock/webQuerysdlist.htm",{teacherid:e,pageSize:r.row,currentPage:r.page},function(e){e.pageNumber=_.max([1,Math.ceil(+e.total/r.row)]),t.resolve(e)}),t.promise()},yndata.getMonthIncome=function(e){var r=$.Deferred();return $.getJSON("/webstock/webQueryMothlist.htm",{teacherid:e},function(e){r.resolve(e)}),r.promise()},yndata.getRelativeVideo=function(e,r){r=_.extend({page:1,row:5},r);var t=$.Deferred();return $.getJSON("/video/collageList.htm",{teacherId:e,pageSize:r.row,currentPage:r.page},function(e){e.pageNumber=_.max([1,Math.ceil(+e.total/r.row)]),t.resolve(e)}),t.promise()},yndata.getVideoComment=function(e,r){r=_.extend({page:1,row:5},r);var t=$.Deferred();return $.getJSON("/videoCommentList.htm",{videoId:e,pageSize:r.row,currentPage:r.page},function(e){e.pageNumber=_.max([1,Math.ceil(+e.commentCount/r.row)]),t.resolve(e)}),t.promise()},yndata.postVideoComment=function(e,r){var t=$.Deferred();return $.post("/auth/videoCommentReply.htm",{video_id:e,content:r},function(e){"1"==e.status?(layer.msg("评论成功!"),t.resolve()):(layer.msg("评论失败"),t.reject())},"json"),t.promise()},yndata.getAlbumInfo=function(e){ops=_.extend({page:1,row:5});var r={albumId:e,currentPage:ops.page,pageSize:ops.row},t=$.Deferred();return $.getJSON("/video/albumList.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getViewCount=function(e){var r=$.Deferred();return $.getJSON("/articleViewCount.htm",{articleId:e},function(e){1==+e.status?r.resolve(e):(console.log("xxx: yndata.getViewCount error...",e),r.reject())}),r.promise()},yndata.like=function(e){var r=$.Deferred();return $.post("/html/zanArticle.htm",{article_id:e},function(e){"success"==e&&(layer.msg("谢谢您的赞美..."),r.resolve(e)),"complete"==e&&(layer.msg("您已经赞美过啦..."),r.reject())}),r.promise()},yndata.postMsg=function(e,r,t){var n=$.Deferred(),a={acceptid:e,creatorid:ynUserId,content:r};return t&&(a.id=t),$.post("/letter/questionLetter.htm",a,function(e){"success"==e&&(layer.msg("发送成功"),n.resolve()),0==+e&&(layer.alert("参数为空"),n.reject())}),n.promise()},yndata.getMyMsg=function(e){e=_.extend({page:1,row:10,type:0},e);var r={currentPage:e.page,pageSize:e.row};if(1===+e.type)r.creatorid=ynUserId;else{if(0!==+e.type)return void layer.msg("getMyMsg : type参数错误 : [0, 1]");r.acceptid=ynUserId}var t=$.Deferred();return $.getJSON("/letter/queryLetterList.htm",r,function(r){return 0==+r?(layer.alert("参数为空"),void t.reject()):11==+r?(layer.alert("参数错误"),void t.reject()):(r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),void t.resolve(r))}),t.promise()},yndata.getNewsPush=function(e){e=_.extend({page:1,row:10},e);var r={currentPage:e.page,pageSize:e.row},t=$.Deferred();return $.getJSON("/getAttentionUserList.htm",r,function(r){return 0==+r?(layer.alert("参数为空"),void t.reject()):11==+r?(layer.alert("参数错误"),void t.reject()):(r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),void t.resolve(r))}),t.promise()},yndata.getrecord=function(){var e=$.Deferred();return $.getJSON("/getTeacher_message.htm",function(r){return 0==+r?(layer.alert("参数为空"),void e.reject()):11==+r?(layer.alert("参数错误"),void e.reject()):void e.resolve(r)}),e.promise()},yndata.queryNoteDetail=function(e){var r=$.Deferred();return $.getJSON("/consultation/queryNoteDetail.htm",{noteid:e},function(e){r.resolve(e)}),r.promise()},yndata.answerask=function(e){e=_.extend({page:1,row:5},e);var r=$.Deferred();return $.getJSON("/consultation/queryAnswerRanking.htm",{currentPage:e.page,pageSize:e.row},function(e){r.resolve(e)}),r.promise()},yndata.rising=function(e){e=_.extend({page:1,row:10,type:0},e);var r={currentPage:e.page,pageSize:e.row,singtype:e.type},t=$.Deferred();return $.getJSON("/consultation/querySeeStockTrent.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getOnlineTeacher=function(e){var r=$.Deferred();e=_.extend({row:5,page:1,userid:ynUserId},e);var t={pageSize:e.row,currentPage:e.page,userid:e.userid};return $.getJSON("/consultation/queryOnlineTeacher.htm",t,function(e){r.resolve(e)}),r.promise()},yndata.queryOnlineTeacher=function(e){e=e||"";var r=$.Deferred();return $.getJSON("/consultation/queryLikeTeacher.htm",{likename:e},function(e){r.resolve(e)}),r.promise()},yndata.noAnswer=function(e){e=_.extend({page:1,row:10},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:ynUserId},t=$.Deferred();return $.getJSON("/center/queryNoAnswer.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.yesAnswer=function(e){e=_.extend({page:1,row:10},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:ynUserId},t=$.Deferred();return $.getJSON("/center/queryYesAnswer.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.evalAnswer=function(e){e=_.extend({page:1,row:10},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:ynUserId},t=$.Deferred();return $.getJSON("/center/queryEvalAnswer.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getStatistics=function(e){e=_.extend({teacherId:ynTeacherId},e);var r=$.Deferred();return $.getJSON("/center/queryTeacherAskStock.htm",{answeruserid:e.teacherId,t:yn.timestamp()},function(e){r.resolve(e)}),r.promise()},yndata.question_mention=function(e){e=_.extend({teacherId:ynTeacherId,page:1,row:10},e);var r=$.Deferred();return $.getJSON("/center/queryATeacherNote.htm",{teacherid:e.teacherId,currentPage:e.page,pageSize:e.row,t:yn.timestamp()},function(t){t.pageNubmer=_.max([1,Math.ceil(+t.total/e.row)]),r.resolve(t)}),r.promise()},yndata.question_all=function(e){e=_.extend({teacherid:ynTeacherId,page:1,row:10},e);var r=$.Deferred();return $.getJSON("/center/queryTeacherUnAnswered.htm",{currentPage:e.page,pageSize:e.row,teacherid:e.teacherid,t:yn.timestamp()},function(t){t.pageNubmer=_.max([1,Math.ceil(+t.total/e.row)]),r.resolve(t)}),r.promise()},yndata.question_done=function(e){e=_.extend({teacherId:ynTeacherId,page:1,row:10},e);var r=$.Deferred();return $.getJSON("/center/queryTeacherYesAnswer.htm",{teacherid:e.teacherId,currentPage:e.page,pageSize:e.row,t:yn.timestamp()},function(t){return 0==+t?void layer.msg("参数错误 : 请确认当前用户角色是否为老师"):(t.pageNubmer=_.max([1,Math.ceil(+t.total/e.row)]),void r.resolve(t))}),r.promise()},yndata.noAnswer=function(e){e=_.extend({page:1,row:10,userId:ynUserId},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:e.userId},t=$.Deferred();return $.getJSON("/center/queryNoAnswer.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.evalAnswer=function(e){e=_.extend({page:1,row:10,userId:ynUserId},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:e.userId},t=$.Deferred();return $.getJSON("/center/queryEvalAnswer.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.yesAnswer=function(e){e=_.extend({page:1,row:10,userId:ynUserId},e);var r={currentPage:e.page,pageSize:e.row,questionuserid:e.userId},t=$.Deferred();return $.getJSON("/center/queryYesAnswer.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.getAskTimes=function(){var e=$.Deferred();return $.getJSON("/consultation/queryTodayQuestionCount.htm",{questionuserid:ynUserId,t:yn.timestamp()},function(r){e.resolve(ynconfig.totalAskTime-r.rows)}),e.promise()},yndata.postplaytour=function(e,r,t){var n=$.Deferred(),a={actual_price:e,teacherid:r,goodsId:t,consumption_name:"打赏观点",consumption_type:0,consumption_source:0,user_id:ynUserId,price:e,discount_price:e};return $.post("/reward/rewardTheacher.htm",a,function(e){"success"==e?(layer.msg("打赏成功,感谢打赏!"),n.resolve()):(layer.msg("打赏失败!"),n.reject())}),n.promise()},yndata.postGift=function(e){var r=$.Deferred(),t={orderNum:e.orderNum};return console.log(t),$.post("/reward/rewardTheacher.htm",t,function(e){r.resolve(e)}),r.promise()},yndata.balance=function(){var e=$.Deferred();return $.getJSON("/useraccount/pay_useraccountDetail.htm",{user_id:ynUserId},function(r){e.resolve(r)}),e.promise()},yndata.getOpinion=function(e){e=_.extend({teacherid:"",page:1,row:10,type:null},e);var r={pageSize:e.row,currentPage:e.page,classify:e.type,teacherid:e.teacherid},t=$.Deferred();return $.getJSON("/opinion/queryNewOpinions.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()},yndata.getOpinionBest=function(e){e=_.extend({page:1,row:10},e);var r={pageSize:e.row,currentPage:e.page},t=$.Deferred();return $.getJSON("/opinion/queryOpinionTeacher.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getNewsList=function(e){var r=$.Deferred();e=_.extend({type:"",page:1,row:20},e);var t={backnews_type:e.type,currentPage:e.page,pageSize:e.row};return $.getJSON("/article/queryNews.htm",t,function(t){t.pageNumber=_.max([1,Math.ceil(+t.total/e.row)]),r.resolve(t)}),r.promise()},yndata.rencharge=function(e){var r=$.Deferred(),t={pay_source:0,totalPrice:e,orderType:0};return console.log(t),$.post("/app/appRechargeOrder.htm",t,function(e){r.resolve(e)},"json"),r.promise()},yndata.indentNum=function(e){e=_.extend({pay_source:0},e);var r={goodsId:e.goodsId,goodsType:e.goodsType,totalPrice:e.totalPrice,pay_source:e.pay_source,teacherId:e.teacherId};console.log(r);var t=$.Deferred();return $.post("/app/appRewardPayOrder.htm",r,function(e){t.resolve(e)},"json"),t.promise()},yndata.alipay=function(e){var r=$.Deferred();return $.post("/web/webPay.htm",{orderNum:e},function(e){r.resolve(e)}),r.promise()},yndata.payStatus=function(){var e=$.Deferred();return $.post("/web/getPayStatus.htm",function(r){e.resolve(r)}),e.promise()},yndata.referindentNum=function(e){e=_.extend({pay_source:0},e);var r={goodsId:e.goodsId,goodsType:e.goodsType,buy_number:1,pay_source:e.pay_source},t=$.Deferred();return $.post("/app/buyGoodsPayOrder.htm",r,function(e){t.resolve(e)},"json"),t.promise()},yndata.addViewCount=function(e){var r=$.Deferred();return $.post("/article/addNewsViewCount.htm",{backnews_id:e},function(e){r.resolve()}),r.promise()},yndata.getViewCount=function(e){var r=$.Deferred();return $.getJSON("/article/queryNewsViewAndZanCount.htm",{backnews_id:e},function(e){r.resolve(e)}),r.promise()},yndata.queryOpinion=function(e){var r=$.Deferred();e=_.extend({teacherid:"",page:1,row:5,type:"viewnumber"},e);var t={currentPage:e.page,pageSize:e.row,orderbyStr:e.type,teacherid:e.teacherid};return $.getJSON("/opinion/queryOrderByStrOpinion.htm",t,function(e){console.log("查询观点",e),r.resolve(e)}),r.promise()},yndata.queryTeacherHotAnswer=function(e,r){var t=$.Deferred();r=_.extend({teacherid:e,sort:"note_readcount",page:1,row:10},r);var n={teacherid:r.teacherid,orderByStr:r.sort,pageSize:r.row,currentPage:r.page};return $.getJSON("/live/queryTeacherHotAnswer.htm",n,function(e){t.resolve(e)}),t.promise()},yndata.getTeacherBestOpinion=function(e,r){var t=$.Deferred();r=_.extend({order:"viewnumber",page:1,row:6},r);var n={teacherid:e,orderbyStr:r.order,pageSize:r.row,currentPage:r.page};return $.getJSON("/opinion/queryOrderByStrOpinion.htm",n,function(e){console.log("-----===========",e),t.resolve(e)}),t.promise()},yndata.getTeacherLiveInfo=function(e,r){r=_.extend({id:"",page:1,row:10},r);var t={id:r.id,teacherid:e,currentPage:r.page,pageSize:r.row},n=$.Deferred();return $.getJSON("/live/liveDetailByTeacherid.htm",t,function(e){n.resolve(e)}),n.promise()},yndata.referInquire=function(e){e=_.extend({id:""},e);var r={id:e.id},t=$.Deferred();return $.getJSON("/reference/referbyid.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getregerp=function(e){e=_.extend({referenceid:referenceid,currentPage:1,pageSize:10},e);var r={referenceid:e.referenceid,pageSize:e.pageSize,currentPage:e.currentPage},t=$.Deferred();return $.getJSON("/reference_periodical/list.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.pageSize)]),t.resolve(r)}),t.promise()},yndata.addReferp=function(e){e=_.extend({referenceid:referenceid,content:"",puiblisher:puiblisher,puiblisherid:puiblisherid},e);var r={referenceid:e.referenceid,content:e.content,puiblisher:e.puiblisher,puiblisherid:e.puiblisherid},t=$.Deferred();return $.post("/reference_periodical/add.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.commontlist=function(e){e=_.extend({type:0,content:"",referenceid:referenceid,user_id:ynUserId,productStatus:status,pageSize:10,currentPage:1},e);var r={type:e.type,content:e.content,reference_id:e.referenceid,user_id:e.user_id,productStatus:e.productStatus,pageSize:e.pageSize,currentPage:e.currentPage},t=$.Deferred();return $.getJSON("/reference/commentList.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.pageSize)]),t.resolve(r)}),t.promise()},yndata.upCommont=function(e){e=_.extend({reference_id:referenceid,create_id:ynUserId},e);var r={reference_id:e.reference_id,parent_id:e.parent_id,create_id:e.create_id,content:e.content},t=$.Deferred();return $.post("/reference/addComment.htm",r,function(e){"success"==e&&layer.msg("评论成功！"),t.resolve(e)}),t.promise()},yndata.TARefer=function(e){e=_.extend({puiblisherid:puiblisherid,userId:ynTeacherId,pageSize:5,currentPage:1},e);var r={puiblisherid:e.puiblisherid,userId:e.userId,pageSize:e.pageSize,currentPage:e.currentPage},t=$.Deferred();return $.getJSON("/center/reference/teacherReferenceList.htm",r,function(e){t.resolve(e)}),t.promise()},yndata.getone=function(e){e=_.extend({audit:"",status:"",productStatus:"",puiblisherid:ynUserId,page:1,row:10},e);var r={audit:e.audit,type:ynIsTeacher,status:e.status,productStatus:e.productStatus,puiblisherid:e.puiblisherid,currentPage:e.page,pageSize:e.row},t=$.Deferred();return $.getJSON("/center/reference/list.htm",r,function(r){r.pageNumber=_.max([1,Math.ceil(+r.total/e.row)]),t.resolve(r)}),t.promise()};