!function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="/public/source/",n(0)}([function(t,n){"use strict";window.ynmodule={},ynmodule.loading=function(t){_.extend(this,t)},ynmodule.loading.prototype={container:null,type:2,margin:60,render:function(){var t='<div class="loading" style="text-align:center;"><img class="inline" style="margin:'+this.margin+'px 0;" src="/public/icons/loading'+this.type+'.gif"/></div>';this.container.html(t)}},ynmodule.msg=function(){var t={container:$("#ynmsg"),overlay:$("#ynmsg-overlay"),trigger:null,textarea:null,button:null,teacherId:null,wordCount:null,init:function(){var t=this;this.trigger=this.container.find(".trigger"),this.textarea=this.container.find("textarea"),this.button=this.container.find(".submit"),this.wordCount=this.container.find(".wordCount .value"),this.align(),this.event(),yn.showStockList(this.trigger,{listLen:5,fixed:!0,onSelect:function(n){var e=t.textarea.val();t.textarea.val(e+n.stockWrap).trigger("keyup"),t.trigger.val("")}}),yn.wordCount(this.textarea,{indicate:this.wordCount,limit:200})},align:function(t){var n=$(window).width(),e=$(window).height(),i=this.container.width(),o=this.container.height(),a=(n-i)/2,r=(e-o)/2;this.overlay.css({width:n+"px",height:e+"px"}),this.container.css({left:a+"px",top:r+"px"})},reset:function(){this.trigger.val(""),this.textarea.val("")},render:function(t){this.teacherId=t,this.reset(),this.overlay.show(),yn.bodyScroll(!1)},event:function(){var t=this;this.overlay.click(function(){$(this).hide(),yn.bodyScroll(!0)}),this.container.on("click",".close",function(){t.overlay.hide(),yn.bodyScroll(!0)}),this.container.click(function(){return!1}),this.container.on("click",".submit",function(){if(!t.teacherId)return void layer.alert("ynmoudle.quiz : teacherId error...");var n=t.textarea.val();return n?void yndata.postMsg(t.teacherId,n).done(function(){yn.bodyScroll(!0),t.overlay.hide()}):void layer.alert("内容不能为空")})}};return t.init(),t},ynmodule.mass=function(){var t={container:$(".ynmodule-mass"),overlay:$(".friends-mass"),input:null,textarea:null,button:null,wordCount:null,init:function(){this.textarea=this.container.find("textarea"),this.button=this.container.find(".submit"),this.wordCount=this.container.find(".wordCount .value"),this.input=this.container.find("input"),this.align(),this.event(),yn.wordCount(this.textarea,{indicate:this.wordCount,limit:200})},align:function(t){var n=$(window).width(),e=$(window).height(),i=this.container.width(),o=this.container.height(),a=(n-i)/2,r=(e-o)/2;this.overlay.css({width:n+"px",height:e+"px"}),this.container.css({left:a+"px",top:r+"px"})},reset:function(){this.textarea.val(""),this.input.val("")},render:function(){this.reset(),this.overlay.show(),yn.bodyScroll(!1)},event:function(){var t=this;this.overlay.click(function(){$(this).hide(),yn.bodyScroll(!0)}),this.container.on("click",".close",function(){t.overlay.hide(),yn.bodyScroll(!0)}),this.container.click(function(){return!1})}};return t.init(),t};var e=function(){};e.prototype={$times:null,select:null,textarea:null,judge:null,online:null,stockList:null,init:function(){var t=this;yndata.getAskTimes().done(function(n){return+n<1?void layer.alert("您今天提问次数已经达到上限"):void t.$times.text(n)})}},ynmodule.hotAsk=function(){return{container:$("#hotAsk"),items:null,pageSize:5,currentPage:1,count:0,init:function(){var t=this;this.items=this.container.find(".content"),this.event(),this.getData(function(n){t.render(n)})},getData:function(t){yndata.hotAsk({pageSize:this.pageSize,currentPage:this.currentPage}).done(function(n){console.log("热问股票",n),t(n.rows)})},render:function(t){this.items.html(template("hotAsk-template",t)),this.items.find(".item").each(function(){var t=$(this).find(".price"),n=$(this).find(".up"),e=$(this).find(".money");yn.queryStock($(this).data("code"),{handle:!0,color:!0}).done(function(i){t.html(i[3].replace(/>([0-9.]+)</,">￥$1<")),n.html(i[33]),e.html(i[34])})})},event:function(){var t=this;this.container.on("click",".action",function(){t.count++,t.currentPage=t.count%2+1,t.getData(function(n){t.render(n)})})}}},ynmodule.rising=function(){return{container:$("#rising"),items:null,page:1,row:5,percent:null,upline:null,downline:null,loading:null,init:function(){this.items=this.container.find(".content"),this.percent=this.container.find(".percent"),this.upline=this.percent.find(".upline"),this.downline=this.percent.find(".downline"),this.event(),this.loading=new ynmodule.loading,this.loading.type=2,this.loading.container=this.items},render:function(t){var n=this;this.loading.render(),yndata.rising({page:this.page,row:this.row,type:t}).done(function(e){console.log("牛人看涨跌",e),e.rows=_.map(e.rows,function(t){var n=+t.onNum+ +t.downNum;return t.upWidth=t.onNum/n*100,t.downWidth=t.downNum/n*100,t}),e.rows=_.sortBy(e.rows,["downWidth","upWidth"][t]),n.items.html(template("rising-template",e.rows)),n.items.find(".item").each(function(){var t=$(this).find(".price"),n=$(this).find(".up"),e=$(this).find(".money");yn.queryStock($(this).data("code"),{handle:!0,color:!0}).done(function(i){t.html(i[3].replace(/>([0-9.]+)</,">￥$1<")),n.html(i[33]),e.html(i[34])})})})},event:function(){var t=this;this.container.find(".title").on("click","span",function(){$(this).parent().find(".thisclass").removeClass("thisclass"),$(this).addClass("thisclass");var n=$(this).data("id");t.render(n)})}}},ynmodule.answerRanking=function(){return{container:null,page:null,row:null,handler:{showQuestionWindow:function(){}},init:function(t){t=_.extend({wrap:$("body"),page:1,row:5},t);var n='<div id="answerRanking" class="frame">\n                    <div class="title">\n                        <span class="fa-online"></span>\n                        <span class="text">解答排行</span>\n                    </div>\n                    <div class="content"></div>\n                    <script type="text/html" id="answerRanking-template">\n                        {{each}}\n                        <div class="item clear">\n                            <div class="user-head fl">\n                                <a href="/live/liveDetailLive.htm?teacherid={{$value.answeruserid}}">\n                                <img src="{{$value.photo}}" title="{{$value.teachertitle}}"/>\n                                </a>\n                            </div>\n                            <div class="string fl">\n                                <p class="user-name">\n                                    <span>{{$value.teachertitle}}</span>\n                                    <span class="ask-btn fr" data-id="{{$value.answeruserid}}">向TA提问</span>\n                                </p>\n                                <p class="count">回答<span>{{$value.answercount}}</span>有帮助<span>{{$value.zancount}}</span></p>\n                            </div>\n                        </div>\n                        {{/each}}\n                    </script>\n            </div>';t.wrap.append(n),this.page=t.page,this.row=t.row,this.container=$("#answerRanking"),this.event()},render:function(t){var n=this;yndata.answerask({page:this.page,row:this.row}).done(function(t){console.log(" 解答排行",t),t=t.rows.sort(function(t,n){return+n.answercount-+t.answercount}),n.container.find(".content").html(template("answerRanking-template",t))})},handleData:function(t){return _.map(t,function(t){return t})},event:function(){var t=this;this.container.on("click",".ask-btn",function(){var n=$(this).data("id"),e=$(this).prev().text(),i={id:n,name:e};t.handler.showQuestionWindow(i)})}}},ynmodule.ReativeAsk=function(){},ynmodule.ReativeAsk.prototype={stockCode:null,stockName:null,page:1,row:5,init:function(t,n){this.stockCode=n,this.stockName=t},getData:function(t){var n=this;$.getJSON("/consultation/queryAboutStocktrend.htm",{stockcode:n.stockCode,currentPage:n.page,pageSize:n.row},function(n){n=n.rows,t(n)})},render:function(){if(this.stockCode){var t=this,n=$("#relativeChat"),e=n.find(".items"),i=n.find(".name"),o=n.find(".code"),a=n.find(".txts .up .value"),r=n.find(".txts .down .value"),s=n.find(".line .up"),c=n.find(".line .down"),l=n.find(".title a");n.show(),i.text(this.stockName),o.text(this.stockCode),l.attr("href","/marketLine.htm?stockcode="+this.stockCode),this.getData(function(n){console.log("相关问答",n),a.text(n.onCount),r.text(n.downCount);var i=+n.onCount+ +n.downCount;s.css("width",n.onCount/i*100+"%"),c.css("width",n.downCount/i*100+"%");var o=t.handle(n.note);e.html(template("old-template",o))})}},handle:function(t){return _.map(t,function(t){return t.questiontime=yn.timeFormat(t.questiontime),t})}},ynmodule.playtour=function(){return{container:$("#playtour"),group:$("#playtour .group"),optional:$("#playtour #optional"),confirmPrice:$("#playtour .confirmPrice"),getPrice:$("#playtour .getPrice"),goodsId:null,balance:null,init:function(){var t=this;yn.centerBox(this.container),this.event(),yndata.balance().done(function(n){t.container.find(".balance .fl").text("可用余额"+n.balance+"牛币")})},event:function(){var t=this;this.container.on("click","> .close",function(n){t.confirmPrice.hide(),t.getPrice.show(),t.container.hide()}),this.group.on("click","span",function(){$(this).parent().find(".thistype").removeClass("thistype"),$(this).addClass("thistype");var n=t.container.find(".thistype").data("type");t.optional.val(n),t.optional.focus()}),this.container.on("change",".agreement",function(){var t=$(this).get(0).checked;t?($("#pay-jump").show(),$("#pay-jump-button").hide()):($("#pay-jump").hide(),$("#pay-jump-button").show())}),this.container.on("click",".submit",function(){var n=$(".publish-source").data("id"),e=t.optional.val();return/^[1-9][0-9]*$/.test(e)?(t.confirmPrice.show(),t.getPrice.hide(),t.confirmPrice.find(".payName").html("观点打赏"),$("#shouldPayValue").html(e),$("#finalPayValue").html(e),void yndata.indentNum({goodsId:t.goodsId,goodsType:0,totalPrice:e,teacherId:n}).done(function(t){if("1"!=t.status)return void layer.msg("参数错误 : "+t.status);var n="/html/returnshortcutpayJsp.htm?orderNum="+t.data.orderNum;$("#pay-jump").attr("href",n)})):void layer.msg("客官，真的不能再少了(╯﹏╰) !")}),$("#pay-jump").on("click",function(){t.reset();var n=new ynmodule.JudgePay;n.init(),n.render()})},reset:function(){this.confirmPrice.hide(),this.getPrice.show(),this.container.hide(),this.container.find("input").val("")},render:function(t){var n=this;this.goodsId=t,this.container.velocity("transition.expandIn",{duration:300}),this.optional.val(""),this.group.find(".thistype").removeClass("thistype"),yndata.balance().done(function(t){n.balance=t.balance,n.container.find(".balance .fl").text("可用余额"+t.balance+"牛币")})}}},ynmodule.JudgePay=function(){},ynmodule.JudgePay.prototype={container:null,init:function(){var t=this;this.container=$("#judgePay"),yn.centerBox(this.container),this.container.on("click","> .close",function(n){t.container.hide()}),this.container.on("click","#finishPay",function(){yndata.payStatus().done(function(n){console.log(n),"1"==n||"6"==n?(layer.msg("支付完成！感谢打赏老师！"),t.container.hide()):layer.msg("支付未完成！请稍后再试！")})})},render:function(){this.container.show(),this.container.velocity("transition.expandIn",{duration:300})}},ynmodule.opinionType=function(){this.container=null,this.select=0},ynmodule.opinionType.prototype={init:function(){var t=this;this.container.on("click",".opinionType-item",function(){$(this).parent().find(".select").removeClass("select"),$(this).addClass("select");var n=$(this).data("id");t.delegate.click(n)})},render:function(t){this.container.html(yn.opinionType({select:this.select}))},delegate:{click:function(t){alert(t)}}},ynmodule.opinionList=function(){},ynmodule.opinionList.prototype={container:null,teacherid:null,bootpag:null,page:1,row:15,type:0,init:function(){var t=this;this.bootpag&&this.bootpag.on("page",function(n,e){t.page=e,t.render()})},render:function(){function t(t){return _.map(t,function(t){return t.create_time=yn.timeFormat(t.create_time),t.detail="/article/newDetail.htm?article_id="+t.article_id,t.trendStyle=t.stock_trend||"hide",t.trend_text=["看涨","看跌"][t.stock_trend],t})}function n(t){if(e.bootpag){if(t==-1)return void e.bootpag.hide();e.bootpag.show(),e.bootpag.bootpag({page:e.page,total:t})}}var e=this;yndata.getOpinion({page:this.page,row:this.row,type:this.type,teacherid:this.teacherid}).done(function(i){return console.log("观点列表",i),i.rows=t(i.rows),i.rows.length<1?(e.container.html(ynconfig.none({margin:100})),void n(-1)):(e.container.html(template("opinion-list-item-template",i.rows)),n(i.pageNumber),void e.delegate.done({total:i.total}))})},delegate:{done:function(t){}}},ynmodule.hotOpinion=function(){var t,n=function(t){return _.map(t,function(t,n){return t.create_time=yn.timeFormat(t.create_time),t.index=n+1,t.red=n<=2,t.noteType=ynconfig.opinionType[t.classify].name,t.detail="/article/newDetail.htm?article_id="+t.article_id,t})},e=function(t){return _.map(t,function(t){return'<div class="hot-opinion-item">\n                    <span class="index '+t.red+'">'+t.index+'</span>\n                    <div class="content">\n                        <a href="'+t.detail+'" target="_blank" class="name">'+t.title+'</a>\n                        <div class="info">\n                            <span class="author">'+t.createrName+'</span>\n                            <span class="time">'+t.create_time+'</span>\n                            <span class="noteType"><i class="yn-icon yn-icon-note"></i>'+t.noteType+"</span>\n                        </div>\n                    </div>\n                </div>"}).join("")};return{init:function(n){t=n},render:function(){yndata.queryOpinion().done(function(i){t.html(e(n(i.rows)))})}}},ynmodule.face=function(){this.container=$("#expression-wrap")},ynmodule.face.prototype={init:function(){var t=this.container.find(".hand"),n=$("#bqInfos"),e=n.find(".title"),i=n.find(".gif"),o=this;t.on("mouseenter",function(t){var o=$(this).position();n.css({left:o.left-10,top:o.top-55}),e.text($(this).data("title")),i.attr("src","/public/icons/face/"+$(this).data("code")+".gif"),n.show()}),this.container.on("mouseleave",function(){n.hide(),$(this).hide()}),t.on("click",function(){var t=$(this).data("code");return o.delegate.select("[face="+t+"]"),o.container.hide(),!1})},render:function(t){this.container.show().css({left:t.left,top:t.top})},delegate:{select:function(t){alert(t)}}},ynmodule.AskStockWithTeacher=function(){},ynmodule.AskStockWithTeacher.prototype={container:null,teacherid:null,type:"",page:1,row:15,bootpag:null,total:-1,init:function(){},render:function(){var t=this,n=function(n){if(t.bootpag){if(n==-1)return void t.bootpag.hide();t.bootpag.show(),t.bootpag.bootpag({page:t.page,total:n})}};yndata.getMyAnswerWithType(this.teacherid,{page:this.page,row:this.row,type:this.type}).done(function(e){return console.log("问答列表",e),e.rows=t.handleData(e.rows),e.rows.length<1?(t.container.html(ynconfig.none({margin:100})),void n(-1)):(t.container.html(template("answer-list-template",e.rows)),n(e.pageNumber),void(""===t.type&&+t.total==-1&&(t.total=e.total,t.delegate.done({total:e.total}))))})},handleData:function(t){return _.map(t,function(t){return t.answertime=yn.timeFormat(t.answertime),t.answercontent=yn.filterHTML(t.answercontent),t})},delegate:{done:function(t){}}},ynmodule.AskStockCategory=function(){this.select=-1,this.container=null,this.hasAll=!0},ynmodule.AskStockCategory.prototype={init:function(){var t=this;this.container.on("click",".askStock-category-item",function(){$(this).parent().find(".select").removeClass("select"),$(this).addClass("select");var n=$(this).data("id");t.delegate.click(n)})},render:function(){var t={select:this.select};t.hasAll=this.hasAll,this.hasAll||(t.select=2),this.container.append(yn.getAskStockCategory(t))},delegate:{click:function(t){alert(t)}}};var i=function(){};i.prototype={teacherid:null,container:null,row:8,sort:"note_readcount",render:function(){function t(t){return _.map(t,function(t){return t._title=t.questioncontent,t._content=yn.filterHTML(t.answercontent),t._time=yn.timeFormat(t.answertime),t._link="/consultation/askStockDetail.htm?id="+t.noteid,t._class_time="show",t._class_view="show",t._count_view=t.note_readcount,t})}var n=this;yndata.queryTeacherHotAnswer(this.teacherid,{row:n.row,sort:n.sort}).done(function(e){var i=t(e.rows),a=new o;a.container=n.container,a.data=i,a.init(),a.render()})}};var o=function(){this.container=null,this.data=null};o.prototype={init:function(){},render:function(){this.data=this.dataMap(this.data),this.container.html(template("tableView-template",this.data))},dataMap:function(t){return _.map(t,function(t){return t._title=t._title||"",t._content=t._content||"",t._time=t._time||"",t._link=t._link||"#",t._count_view=t._count_view||"",t._count_zan=t._count_zan||"",t._count_comment=t._count_comment||"",t._class_content=t._style_content||"",t._class_time=t._class_time||"hide",t._class_zan=t._class_zan||"hide",t._class_view=t._class_view||"hide",t._class_comment=t._class_comment||"hide",t})}};var a=function(){};a.prototype={order:"viewnumber",container:null,teacherid:null,row:5,init:function(){},render:function(){var t=this,n=function(t){return _.map(t,function(t){return t._content=function(){var n="";return n=t.opinionShortContent.replace(/^【.+?】/,"")}(),t})};yndata.getTeacherBestOpinion(this.teacherid,{row:this.row,order:this.order}).done(function(e){console.log("精彩观点",e),e.rows=n(e.rows),t.container.html(template("bestOpinion-list-template",e.rows))})}};var r=function(){};r.prototype={container:null,teacherId:null,ItemId:"",page:1,row:3,init:function(){},render:function(){function t(t){return _.map(t,function(t){return t.contentFilter.length>100&&(t.contentFilter=t.contentFilter.substr(0,100)+"..."),t})}function n(t){return _.map(t,function(t){return'<div class="living-item">\n                    <div class="living-time">'+t.pubtimeString+'</div>\n                    <div class="living-content">'+t.contentFilter+"</div>\n                </div>"}).join("")}var e=this;yndata.getTeacherLiveInfo(this.teacherId,{page:this.page,row:this.row,id:this.ItemId}).done(function(i){if(console.log("直播信息",i),!(+i.total<1)){var o=t(i.rows.periodical);e.container.html(n(o))}})}},ynmodule.subscription=function(){return{container:$("#subscription"),group:$("#subscription .group"),confirmPrice:$("#subscription .confirmPrice"),getPrice:$("#subscription .getPrice"),goodsId:null,balance:null,teacherid:null,optional:null,init:function(){var t=this;yn.centerBox(this.container),this.event(),yndata.balance().done(function(n){t.container.find(".balance .fl").html("可用余额"+n.balance+"牛币")})},event:function(){var t=this;this.container.on("click","> .close",function(n){t.confirmPrice.hide(),t.getPrice.show(),t.container.hide()}),this.container.on("change",".agreement",function(){var t=$(this).get(0).checked;t?($("#pay-jump").show(),$("#pay-jump-button").hide()):($("#pay-jump").hide(),$("#pay-jump-button").show())}),this.container.on("click",".submit",function(){t.confirmPrice.show(),t.getPrice.hide(),t.confirmPrice.find(".payName").html("内参订阅"),$("#shouldPayValue").html(t.optional),$("#finalPayValue").html(t.optional),yndata.referindentNum({goodsId:t.goodsId,goodsType:3}).done(function(t){if("1"!=t.status)return void layer.msg("参数错误 : "+t.status);var n="/html/returnshortcutpayJsp.htm?orderNum="+t.data.orderNum;$("#pay-jump").attr("href",n)})}),this.container.on("click","#pay-jump",function(){t.reset();var n=new ynmodule.JudgePay;n.init(),n.render()})},reset:function(){this.confirmPrice.hide(),this.getPrice.show(),this.container.hide()},render:function(t){var n=this;this.goodsId=t,this.container.velocity("transition.expandIn",{duration:300}),yndata.balance().done(function(t){this.balance=t.balance}),yndata.referInquire({id:t}).done(function(t){n.handle(t)})},handle:function(t){this.teacherid=t.teacherid,this.optional=t.price,this.container.find(".group .title").html(t.title),this.container.find(".price").html(t.price)}}},ynmodule.PostComment=function(t){_.extend(this,t)},ynmodule.PostComment.prototype={container:null,limit:200,parentId:null,reply:null,init:function(){var t=this;this.container=$("#ynPostComment");var n=this.container.find("textarea"),e=this.container.find(".face-holder"),i=this.container.find(".submit");this.reply=this.container.find(".reply"),this.container.find(".wordValue").text(this.limit),yn.wordCount(n,{indicate:this.container.find(".word-indicate"),limit:this.limit}),n.on("focus",function(){if(!ynIsLogin)return yn.login.render(),void n.blur()}),i.click(_.debounce(function(){var e=n.val();if(!e||e.length<3)return void layer.msg("至少3个字");var i={value:e};t.parentId&&(i.parentId=t.parentId),t.delegate.submit(i),o()},2e3,{leading:!0,trailing:!1}));var o=function(){t.parentId=null,t.reply.empty(),n.val("").trigger("keyup")};this.reply.on("click",".reply-close",function(){t.reply.empty(),t.parentId=null});var a=new ynmodule.face;a.init(),a.delegate.select=function(t){var e=n.val();n.val(e+t)},e.click(function(){return ynIsLogin?void a.render($(this).offset()):void yn.login.render()})},addReply:function(t,n){var e='<span class="txt">回复：</span><span class="reply-name">'+n+'</span><span class="reply-close fa fa-times-circle"></span>';this.reply.html(e),this.parentId=t},delegate:{submit:function(){alert("delegate.submit not override")}}},ynmodule.PersonInfo=function(){},ynmodule.PersonInfo.prototype={container:null,uesrId:null,askWindow:null,init:function(){this.askWindow=ynmodule.askWindow(),this.askWindow.init()},render:function(){var t=null,n=this;if(!this.userId)throw"ynmodule.PersonInfo.userId 属性不能为空";var e=function(t){return t._isCare=t.isAttention?"取消关注":"关注",t._isAttentionText=String(t.isAttention),t};$.getJSON("/userinfo/queryUserAllInfo.htm?user_id="+this.userId,function(i){console.log("用户信息",i),t=e(i),n.container.html(template("person-info-template",t)),n.container.on("click","button.care.false",function(){if(!ynIsLogin)return void yn.login.render();var n=$(this);yndata.addCare(ynUserId,t.teacherid).done(function(){n.attr("class","care true").text("取消关注")})}),n.container.on("click","button.care.true",function(){if(!ynIsLogin)return void yn.login.render();var n=$(this);yndata.cancelCare(ynUserId,t.teacherid).done(function(){n.attr("class","care false").text("关注")})}),n.container.find("button.ask").click(function(){return ynIsLogin?(n.askWindow.render(),void n.askWindow.add(i.teacherid,i.title)):void yn.login.render()})})}}}]);